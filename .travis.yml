language: rust
rust:
  - stable
  - beta
  - nightly
cache: cargo
script:
  - rustup target add thumbv7em-none-eabihf

  # Check with no_std target to make sure it really works
  - cargo build --target thumbv7em-none-eabihf --manifest-path core/Cargo.toml

  # Test using a full std crate
  - export RUST_BACKTRACE=full
  - $(cargo test --manifest-path bbqtest/Cargo.toml > test.log) || tail -n 1000 test.log; exit 1
  # - cargo test --release --manifest-path bbqtest/Cargo.toml
